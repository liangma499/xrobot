package identity_test

import (
	"context"
	"testing"
	"tron_robot/internal/component/google/identity"
	"xbase/utils/xconv"
)

func TestNewInstance(t *testing.T) {
	ins := identity.NewInstance(&identity.Config{
		Audience: "756118858784-3hheeceq786vpq9la22ef7prqqg4t5bf.apps.googleusercontent.com",
	})

	idToken := "eyJhbGciOiJSUzI1NiIsImtpZCI6IjU1YzE4OGE4MzU0NmZjMTg4ZTUxNTc2YmE3MjgzNmUwNjAwZThiNzMiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJhenAiOiI3NTYxMTg4NTg3ODQtM2hoZWVjZXE3ODZ2cHE5bGEyMmVmN3BycXFnNHQ1YmYuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQiOiI3NTYxMTg4NTg3ODQtM2hoZWVjZXE3ODZ2cHE5bGEyMmVmN3BycXFnNHQ1YmYuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIiOiIxMDcxNzI5Mjg3MzcwMjcyMjk2MzUiLCJlbWFpbCI6Inl1ZWJhbmZ1eGlhb0BnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmJmIjoxNzA4NTAwNDA3LCJuYW1lIjoiZnV4aWFvIHl1ZWJhbiIsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJeWh5d1RkdXFOWnpwRUJLSW1WNk1UMlh3eEFKZVVKeXA5Y0RVNTZNRjVlUT1zOTYtYyIsImdpdmVuX25hbWUiOiJmdXhpYW8iLCJmYW1pbHlfbmFtZSI6Inl1ZWJhbiIsImxvY2FsZSI6InpoLUNOIiwiaWF0IjoxNzA4NTAwNzA3LCJleHAiOjE3MDg1MDQzMDcsImp0aSI6IjNmZGU2ZTdiZWExYWJlMDBlMGNmNmY3OGUyYzI0MzM1ZWRhYjc3MDgifQ.Zxfl8ek7nYKOKxhAWRB9VetkEvLKY9bosdSdF6sjGUotKVs31qQ-CfwWMtKkH0NOAvDEHO81rbhpzRqC7gh1dXO5j8o7Go5UcX1jv2-Xmsum4hebvV0ujoEwfNcLrqGL4kfEmhlOaSrGwnUynmdCt3A8PPN97umoR8ct9IirszMytaYPFM-Cp2_fJm-H5gauRzr7Q6Jwyi8xROvefcg8N4mxF2qyK8yYlt0ahubC_iNEpv5AJU8HE1H9uRaL1UNwhTG9sCuk3NuNxnTFAmaKHLWsKmD8rohQvFMvXVZaH_skfx4hELfQKgnLXnhiWY-nfvh5vCt4kchvBKe2UGMTgg"

	profile, err := ins.Validate(context.Background(), idToken)
	if err != nil {
		t.Fatal(err)
	}

	t.Log(xconv.Json(profile))
}
